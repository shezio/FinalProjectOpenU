<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×¦×¢×” ××¢×•×“×›× ×ª - ×œ×•×— ×‘×§×¨×” ×¢× AI (××™× ×˜×¨××§×˜×™×‘×™)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rubik', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
        }

        .header-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
        }

        .btn:hover {
            background: white;
            color: #667eea;
        }

        .btn-ai {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border: none;
            animation: pulse 2s infinite;
        }

        .btn-ai:hover {
            background: linear-gradient(135deg, #ff5252 0%, #d63447 100%);
            color: white;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(255, 107, 107, 0);
            }
        }

        .content {
            padding: 40px;
        }

        /* KPI Cards Section */
        .kpi-section {
            margin-bottom: 50px;
        }

        .kpi-section h2 {
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .kpi-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
        }

        .kpi-card .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .kpi-card .value {
            font-size: 36px;
            font-weight: 700;
        }

        /* Charts Section */
        .charts-section {
            margin-bottom: 50px;
        }

        .charts-section h2 {
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .chart-card:hover {
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
        }

        .chart-card h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }

        /* Timeframe Selector */
        .timeframe-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }

        .timeframe-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .timeframe-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .timeframe-btn:hover {
            background: #e0e0e0;
        }

        .timeframe-btn.active:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Data Visualization Section */
        .data-viz-section {
            margin-top: 50px;
        }

        .data-viz-section h2 {
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .full-width-chart {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .full-width-chart h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .chart-container-large {
            position: relative;
            height: 400px;
            width: 100%;
        }

        /* Table Section */
        .table-section {
            margin-top: 50px;
        }

        .table-section h2 {
            font-size: 22px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .table-card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 20px;
            text-align: right;
            font-weight: 700;
            font-size: 14px;
        }

        td {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
        }

        tbody tr:hover {
            background: #f9f9f9;
        }

        /* AI Chat Section */
        .ai-section {
            margin-top: 50px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border-radius: 20px;
            padding: 40px;
            color: white;
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.3);
        }

        .ai-section h2 {
            font-size: 26px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .ai-section p {
            font-size: 16px;
            margin-bottom: 25px;
            opacity: 0.95;
            line-height: 1.6;
        }

        .ai-chat-container {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .ai-chat-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ai-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .ai-chat-messages {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            color: #333;
            max-height: 400px;
            overflow-y: auto;
        }

        .ai-message {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 10px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-message.user {
            background: #f0f0f0;
            text-align: right;
        }

        .ai-message.assistant {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-right: 4px solid #667eea;
        }

        .ai-input-container {
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            background: white;
            color: #333;
        }

        .ai-send-btn {
            background: white;
            color: #ff6b6b;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-send-btn:hover {
            background: #f0f0f0;
        }

        .video-options {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .video-options h4 {
            font-size: 16px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 600;
        }

        .option-group select,
        .option-group input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: white;
            color: #333;
            font-size: 14px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        .generate-video-btn {
            width: 100%;
            background: white;
            color: #ff6b6b;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .generate-video-btn:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #ff6b6b;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            font-weight: 700;
        }

        .video-preview {
            background: #000;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .video-preview video {
            max-width: 100%;
            border-radius: 10px;
        }

        .video-placeholder {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 40px;
            border-radius: 15px;
            font-size: 18px;
            text-align: center;
        }

        .video-placeholder .loading {
            font-size: 48px;
            margin-bottom: 20px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .video-info {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .video-info h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .video-info ul {
            list-style: none;
            padding: 0;
        }

        .video-info li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .video-info li:last-child {
            border-bottom: none;
        }

        /* Progress bar */
        .progress-container {
            margin-top: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .charts-row {
                grid-template-columns: 1fr;
            }

            .kpi-cards {
                grid-template-columns: repeat(2, 1fr);
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .kpi-cards {
                grid-template-columns: 1fr;
            }

            .content {
                padding: 20px;
            }

            .ai-section {
                padding: 25px;
            }
        }

        /* Footer Note */
        .footer {
            background: #f9f9f9;
            padding: 30px 40px;
            border-top: 2px solid #f0f0f0;
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .footer h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .questions-list {
            list-style: none;
            margin: 20px 0;
        }

        .questions-list li {
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .questions-list li:last-child {
            border-bottom: none;
        }

        .new-badge {
            background: #ff6b6b;
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 11px;
            font-weight: 700;
            margin-right: 8px;
        }

        .typing-indicator {
            display: none;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            width: fit-content;
        }

        .typing-indicator.active {
            display: block;
        }

        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            margin: 0 2px;
            background: #667eea;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .success-message {
            background: #4caf50;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .success-message.active {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ×œ×•×— ×‘×§×¨×” ××ª×§×“× ×¢× AI</h1>
            <div class="header-buttons">
                <button class="btn" onclick="refreshDashboard()">ğŸ”„ ×¨×¢× ×Ÿ</button>
                <button class="btn" onclick="exportToPPT()">ğŸ“Š ×™×™×¦×•× PPT</button>
                <button class="btn btn-ai" onclick="scrollToAI()">ğŸ¤– ×™×¦×™×¨×ª ×•×™×“××• AI</button>
            </div>
        </div>

        <div class="content">
            <!-- KPI Cards Section -->
            <div class="kpi-section">
                <h2>ğŸ“ˆ ××“×“×™× ×¢×™×§×¨×™×™×</h2>
                <div class="kpi-cards">
                    <div class="kpi-card">
                        <div class="label">×¡×”"×› ××©×¤×—×•×ª</div>
                        <div class="value">847</div>
                    </div>
                    <div class="kpi-card">
                        <div class="label">××©×¤×—×•×ª ×”×××ª×™× ×•×ª</div>
                        <div class="value">234</div>
                    </div>
                    <div class="kpi-card">
                        <div class="label">×—×•× ×›×•×™×•×ª ×¤×¢×™×œ×•×ª</div>
                        <div class="value">613</div>
                    </div>
                    <div class="kpi-card">
                        <div class="label">×—×•× ×›×™× ×”×××ª×™× ×™×</div>
                        <div class="value">47</div>
                    </div>
                    <div class="kpi-card">
                        <div class="label">×× ×©×™ ×”×¦×•×•×ª</div>
                        <div class="value">23</div>
                    </div>
                </div>
            </div>

            <!-- Pie Charts Section -->
            <div class="charts-section">
                <h2>ğŸ“Š ×ª×¦×•×’×•×ª ×‘×”×ª×¤×œ×’×•×ª</h2>
                
                <div class="charts-row">
                    <div class="chart-card">
                        <h3>×¡×˜×˜×•×¡ ×—×•× ×›×•×™×•×ª ××©×¤×—×•×ª</h3>
                        <div class="chart-container">
                            <canvas id="tutorshipChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>×—×•× ×›×™×: ×××ª×™× ×™× ××•×œ ×¤×¢×™×œ×™×</h3>
                        <div class="chart-container">
                            <canvas id="tutorsStatusChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="chart-card">
                        <h3><span class="new-badge">×—×“×©</span>××©×•×‘ ×œ×¤×™ ×¡×•×’</h3>
                        <div class="timeframe-selector">
                            <button class="timeframe-btn active" onclick="changeTimeframe('week')">×©×‘×•×¢</button>
                            <button class="timeframe-btn" onclick="changeTimeframe('month')">×—×•×“×©</button>
                            <button class="timeframe-btn" onclick="changeTimeframe('year')">×©× ×”</button>
                            <button class="timeframe-btn" onclick="changeTimeframe('all')">×”×›×œ</button>
                        </div>
                        <div class="chart-container">
                            <canvas id="feedbackChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>××©×¤×—×•×ª ×—×“×©×•×ª ×‘×—×•×“×© ×–×”</h3>
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; border-radius: 10px; text-align: center; color: white; height: 350px; display: flex; flex-direction: column; justify-content: center;">
                            <div style="font-size: 72px; font-weight: 700;">67</div>
                            <div style="font-size: 18px; margin-top: 15px; opacity: 0.9;">××©×¤×—×•×ª ×—×“×©×•×ª</div>
                            <div style="font-size: 14px; margin-top: 10px; opacity: 0.8;">+12% ××”×—×•×“×© ×©×¢×‘×¨</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Visualization Section -->
            <div class="data-viz-section">
                <h2>ğŸ“Š ×•×™×–×•××œ×™×–×¦×™×” ×©×œ × ×ª×•× ×™×</h2>

                <div class="full-width-chart">
                    <h3>×¢×¨×™× ×¢× ××¨×‘×™×ª ××©×¤×—×•×ª ×”×××ª×™× ×•×ª</h3>
                    <div class="chart-container-large">
                        <canvas id="citiesChart"></canvas>
                    </div>
                </div>

                <div class="full-width-chart">
                    <h3>×—×•× ×›×•×™×•×ª ××—×¨×•× ×•×ª (20 ×¤×¢×™×œ×•×™×•×ª)</h3>
                    <div class="chart-container-large">
                        <canvas id="recentTutorshipsChart"></canvas>
                    </div>
                </div>

                <div class="full-width-chart">
                    <h3>×”×–×“×× ×•×™×•×ª ×”×ª×××” ×œ×¤×™ ×§×‘×•×¦×•×ª ×’×™×œ</h3>
                    <div class="chart-container-large">
                        <canvas id="ageGroupsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="table-section">
                <h2>ğŸ“‹ ×—×•× ×›×•×™×•×ª ×¤×¢×™×œ×•×ª ××—×¨×•× ×•×ª</h2>
                <div class="table-card">
                    <table>
                        <thead>
                            <tr>
                                <th>×©× ×”×™×œ×“</th>
                                <th>×©× ×”×—×•× ×š</th>
                                <th>×ª××¨×™×š ×”×ª×—×œ×”</th>
                                <th>××©×š ×”×—×•× ×›×•×ª</th>
                                <th>×¡×˜×˜×•×¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>×“×•×“ ×œ×•×™</td>
                                <td>××‘×¨×”× ×›×”×Ÿ</td>
                                <td>15/12/2025</td>
                                <td>3 ×©×‘×•×¢×•×ª</td>
                                <td>ğŸŸ¢ ×¤×¢×™×œ</td>
                            </tr>
                            <tr>
                                <td>×¨×—×œ ××©×”</td>
                                <td>×©×¨×” ×¨×•×–× ×‘×¨×’</td>
                                <td>10/12/2025</td>
                                <td>4 ×©×‘×•×¢×•×ª</td>
                                <td>ğŸŸ¢ ×¤×¢×™×œ</td>
                            </tr>
                            <tr>
                                <td>×™×¢×§×‘ ×‘×Ÿ</td>
                                <td>××•×˜×™ ×’×“×•×œ</td>
                                <td>08/12/2025</td>
                                <td>5 ×©×‘×•×¢×•×ª</td>
                                <td>ğŸŸ¢ ×¤×¢×™×œ</td>
                            </tr>
                            <tr>
                                <td>××¨×™× ×™×©×¨××œ×™</td>
                                <td>×“×™× ×” ×›×¥</td>
                                <td>05/12/2025</td>
                                <td>6 ×©×‘×•×¢×•×ª</td>
                                <td>ğŸŸ¢ ×¤×¢×™×œ</td>
                            </tr>
                            <tr>
                                <td>××“× ×¡×™× ×™</td>
                                <td>×¨×•× ×™ ×‘×Ÿ</td>
                                <td>01/12/2025</td>
                                <td>2 ×©×‘×•×¢×•×ª</td>
                                <td>ğŸŸ¢ ×¤×¢×™×œ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- AI Video Generation Section -->
            <div class="ai-section" id="ai-section">
                <h2>ğŸ¤– ×™×¦×™×¨×ª ×¡×¨×˜×•×Ÿ ×¡×§×™×¨×” AI</h2>
                <p>×¦×•×¨ ×¡×¨×˜×•×Ÿ ××§×¦×•×¢×™ ×©××¡×§×¨ ××ª ××¦×‘ ×”××¢×¨×›×ª ×¢× ×§×•×œ AI ×‘×˜×•×Ÿ ××§×¦×•×¢×™ ×•×¢×™×¦×•×‘ ×’×¨×¤×™ ××ª×§×“×</p>
                
                <div class="ai-chat-container">
                    <div class="ai-chat-header">
                        <div class="ai-icon">ğŸ¤–</div>
                        <div>
                            <h3 style="margin: 0; font-size: 18px;">×¢×•×–×¨ AI ×œ×¡×§×™×¨×ª ××¦×‘</h3>
                            <p style="margin: 0; font-size: 12px; opacity: 0.8;">×©××œ ××•×ª×™ ×¢×œ ×”× ×ª×•× ×™× ××• ×‘×§×© ×œ×™×™×¦×¨ ×¡×¨×˜×•×Ÿ</p>
                        </div>
                    </div>

                    <div class="ai-chat-messages" id="chat-messages">
                        <div class="ai-message assistant">
                            <strong>AI:</strong> ×©×œ×•×! ×× ×™ ×›××Ÿ ×œ×¢×–×•×¨ ×œ×š ×œ×™×¦×•×¨ ×¡×¨×˜×•×Ÿ ×¡×§×™×¨×” ××§×¦×•×¢×™ ×©×œ ××¦×‘ ×”××¢×¨×›×ª. ××ª×” ×™×›×•×œ ×œ×‘×—×•×¨:<br><br>
                            â€¢ ××™×–×” ×¢××•×“×™× ×œ×›×œ×•×œ (××©×¤×—×•×ª, ×—×•× ×›×™×, ××ª× ×“×‘×™× ×•×›×•')<br>
                            â€¢ ×˜×•×•×— ×–××Ÿ (×©×‘×•×¢, ×—×•×“×©, ×©× ×”)<br>
                            â€¢ ××” ×œ×”×“×’×™×© ×‘×¡×¨×˜×•×Ÿ<br><br>
                            ×¨×•×¦×” ×©××ª×—×™×œ ×¢× ×”×’×“×¨×•×ª ×‘×¨×™×¨×ª ××—×“×œ?
                        </div>
                        <div class="typing-indicator" id="typing-indicator">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>

                    <div class="ai-input-container">
                        <input type="text" class="ai-input" id="user-input" placeholder="×©××œ ××•×ª×™ ××©×”×• ××• ×‘×§×© ×œ×™×¦×•×¨ ×¡×¨×˜×•×Ÿ..." onkeypress="handleEnter(event)">
                        <button class="ai-send-btn" onclick="sendMessage()">×©×œ×—</button>
                    </div>
                </div>

                <div class="video-options">
                    <h4>âš™ï¸ ××¤×©×¨×•×™×•×ª ×¡×¨×˜×•×Ÿ</h4>
                    
                    <div class="option-group">
                        <label>×˜×•×•×— ×–××Ÿ ×œ× ×ª×•× ×™×:</label>
                        <select id="timeRange">
                            <option>×©×‘×•×¢ ××—×¨×•×Ÿ</option>
                            <option selected>×—×•×“×© ××—×¨×•×Ÿ</option>
                            <option>3 ×—×•×“×©×™× ××—×¨×•× ×™×</option>
                            <option>×©× ×” ××—×¨×•× ×”</option>
                            <option>×›×œ ×”×–××Ÿ</option>
                        </select>
                    </div>

                    <div class="option-group">
                        <label>××©×š ×”×¡×¨×˜×•×Ÿ:</label>
                        <select id="videoDuration">
                            <option>1 ×“×§×”</option>
                            <option selected>2-3 ×“×§×•×ª</option>
                            <option>5 ×“×§×•×ª</option>
                            <option>10 ×“×§×•×ª ××œ×</option>
                        </select>
                    </div>

                    <div class="option-group">
                        <label>×‘×—×¨ ×¢××•×“×™× ×œ×›×œ×•×œ ×‘×¡×¨×˜×•×Ÿ:</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" checked id="dash">
                                <label for="dash">×œ×•×— ×‘×§×¨×”</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" checked id="fam">
                                <label for="fam">××©×¤×—×•×ª</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" checked id="tut">
                                <label for="tut">×—×•× ×›×™×</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" checked id="vol">
                                <label for="vol">××ª× ×“×‘×™×</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="feed">
                                <label for="feed">××©×•×‘</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="tasks">
                                <label for="tasks">××©×™××•×ª</label>
                            </div>
                        </div>
                    </div>

                    <div class="option-group">
                        <label>×¡×’× ×•×Ÿ ×”×¡×¨×˜×•×Ÿ:</label>
                        <select id="videoStyle">
                            <option selected>××§×¦×•×¢×™ ×•×¨×©××™</option>
                            <option>×™×“×™×“×•×ª×™ ×•× ×’×™×©</option>
                            <option>××¤×•×¨×˜ ×•×˜×›× ×™</option>
                        </select>
                    </div>

                    <button class="generate-video-btn" onclick="generateVideo()">ğŸ¬ ×¦×•×¨ ×¡×¨×˜×•×Ÿ ×¡×§×™×¨×”</button>
                    
                    <div class="success-message" id="success-message">
                        âœ… ×™×™×¦×•× PowerPoint ×”×•×©×œ× ×‘×”×¦×œ×—×”! ×”×§×•×‘×¥ × ×©××¨ ×œ××—×©×‘ ×©×œ×š.
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>âœ… ×©×™× ×•×™×™× ×©×‘×•×¦×¢×•:</h3>
            <ul class="questions-list">
                <li>âœ… <strong>×”×•×¡×¨: ×”×ª×¤×œ×’×•×ª ×ª×¤×§×™×“×™×</strong> - ×’×¨×£ ×–×” ×”×•×¡×¨ ××”×“×©×‘×•×¨×“</li>
                <li>âœ… <strong>×—×“×©: ××©×•×‘ ×œ×¤×™ ×¡×•×’</strong> - ×’×¨×£ ×¢×•×’×” ×¢× 4 ×¡×•×’×™ ××©×•×‘: ×™×•× ×›×™×£ ×—×•× ×›×™×, ×™×•× ×›×™×£ ××ª× ×“×‘×™×, ×‘×™×§×•×¨ ×‘×‘×™×ª ×—×•×œ×™×, ×—×•× ×›×•×ª ×¨×’×™×œ×”</li>
                <li>âœ… <strong>×—×“×©: ×™×™×¦×•× PPT</strong> - ×›×¤×ª×•×¨ ×œ×™×™×¦×•× ×œ×•×— ×”×‘×§×¨×” ×›×©×§×•×¤×™×ª PowerPoint (×œ×—×¥ ×œ×“×•×’××”!)</li>
                <li>âœ… <strong>×—×“×©: ×™×¦×™×¨×ª ×•×™×“××• AI</strong> - ××¢×¨×›×ª AI ×©×™×•×¦×¨×ª ×¡×¨×˜×•×Ÿ ××§×¦×•×¢×™ ×¢× ×§×¨×™×™× ×•×ª (×œ×—×¥ ×œ×“×•×’××”!)</li>
            </ul>

            <h3 style="margin-top: 30px;">ğŸ¯ ×ª×›×•× ×•×ª ××¢×¨×›×ª AI:</h3>
            <ul class="questions-list">
                <li>ğŸ’¬ <strong>×¦'××˜ ××™× ×˜×¨××§×˜×™×‘×™</strong> - ×©×™×—×” ×¢× AI ×œ×‘×—×™×¨×ª ×¤×¨××˜×¨×™× (× ×¡×” ×œ×©×œ×•×— ×”×•×“×¢×”!)</li>
                <li>ğŸ¬ <strong>×™×¦×™×¨×ª ×•×™×“××• ××•×˜×•××˜×™×ª</strong> - ×¡×¨×˜×•×Ÿ ×¢× ×’×¨×¤×™×§×”, × ×ª×•× ×™× ×•×§×¨×™×™× ×•×ª AI</li>
                <li>â±ï¸ <strong>×‘×—×™×¨×ª ×˜×•×•×— ×–××Ÿ</strong> - ×¡×™× ×•×Ÿ × ×ª×•× ×™× ×œ×¤×™ ×ª×§×•×¤×” (×©×‘×•×¢/×—×•×“×©/×©× ×”)</li>
                <li>ğŸ“„ <strong>×‘×—×™×¨×ª ×¢××•×“×™×</strong> - ×‘×—×¨ ××™×œ×• ×—×œ×§×™× ××”××¢×¨×›×ª ×œ×›×œ×•×œ</li>
                <li>ğŸ¨ <strong>×¡×’× ×•× ×•×ª ×©×•× ×™×</strong> - ××§×¦×•×¢×™, ×™×“×™×“×•×ª×™ ××• ×˜×›× ×™</li>
                <li>ğŸ“Š <strong>×¤×•×¨××˜ ××—×™×“</strong> - ×›×œ ×¡×¨×˜×•×Ÿ ×‘×¤×•×¨××˜ ×–×”×” ×•××§×¦×•×¢×™</li>
            </ul>
        </div>
    </div>

    <!-- Video Modal -->
    <div class="modal" id="video-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">Ã—</button>
            <h2 style="margin-bottom: 20px; color: #333;">ğŸ¬ ×¡×¨×˜×•×Ÿ ×”×¡×§×™×¨×” ×©×œ×š ××•×›×Ÿ!</h2>
            
            <div class="video-preview">
                <div class="video-placeholder">
                    <div class="loading">ğŸ¬</div>
                    <p><strong>×¡×¨×˜×•×Ÿ ×“×•×’××”:</strong> "×¡×§×™×¨×ª ××¢×¨×›×ª ChildSmile - ×—×•×“×© ×“×¦××‘×¨ 2025"</p>
                    <p style="margin-top: 15px; font-size: 14px; opacity: 0.9;">××©×š ×”×¡×¨×˜×•×Ÿ: 2:34 ×“×§×•×ª | ×‘×¡×’× ×•×Ÿ: ××§×¦×•×¢×™ ×•×¨×©××™</p>
                    <p style="margin-top: 10px; font-size: 13px; opacity: 0.8;">×”×¡×¨×˜×•×Ÿ ×”×××™×ª×™ ×™×›×œ×•×œ ×§×¨×™×™× ×•×ª AI, ×’×¨×¤×™× ×× ×™××¦×™×•×ª, × ×ª×•× ×™× ×—×™×™× ×•××•×–×™×§×ª ×¨×§×¢</p>
                </div>
            </div>

            <div class="video-info">
                <h3>ğŸ“Š ×ª×•×›×Ÿ ×”×¡×¨×˜×•×Ÿ:</h3>
                <ul>
                    <li>âœ… ×¤×ª×™×—×”: ××‘×•× ×œ××¢×¨×›×ª ChildSmile ×•×”× ×ª×•× ×™× ×”×—×•×“×©×™×™×</li>
                    <li>âœ… ×œ×•×— ×‘×§×¨×”: 847 ××©×¤×—×•×ª, 613 ×—×•× ×›×•×™×•×ª ×¤×¢×™×œ×•×ª, 234 ××©×¤×—×•×ª ×”×××ª×™× ×•×ª</li>
                    <li>âœ… ××©×¤×—×•×ª: ×¢×œ×™×” ×©×œ 12% ×‘××©×¤×—×•×ª ×—×“×©×•×ª, × ×™×ª×•×— ×œ×¤×™ ×¢×¨×™×</li>
                    <li>âœ… ×—×•× ×›×™×: 47 ×—×•× ×›×™× ×××ª×™× ×™×, ×”×ª×¤×œ×’×•×ª ×œ×¤×™ ×§×‘×•×¦×•×ª ×’×™×œ</li>
                    <li>âœ… ××ª× ×“×‘×™×: ×¤×¢×™×œ×•×ª ××ª× ×“×‘×™×, ××©×•×‘ ×•×‘×™×§×•×¨×™×</li>
                    <li>âœ… ×¡×™×›×•×: ×”××œ×¦×•×ª ×•×”×–×“×× ×•×™×•×ª ×œ×©×™×¤×•×¨</li>
                </ul>
                <p style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
                    <strong>ğŸ’¡ ×”×¢×¨×”:</strong> × ×™×ª×Ÿ ×œ×”×•×¨×™×“ ××ª ×”×¡×¨×˜×•×Ÿ ×‘×¤×•×¨××˜ MP4, ×œ×©×ª×£ ×™×©×™×¨×•×ª ××• ×œ×”×˜××™×¢ ×‘××¦×’×ª.
                </p>
            </div>

            <div class="progress-container">
                <p style="margin-bottom: 10px; font-weight: 600; color: #333;">×”×ª×§×“××•×ª ×™×¦×™×¨×ª ×”×¡×¨×˜×•×Ÿ:</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill">100%</div>
                </div>
            </div>

            <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center;">
                <button class="btn" style="background: #4caf50; color: white;" onclick="downloadVideo()">â¬‡ï¸ ×”×•×¨×“ ×¡×¨×˜×•×Ÿ</button>
                <button class="btn" style="background: #2196F3; color: white;" onclick="alert('×ª×›×•× ×ª ×©×œ×™×—×” ×‘××™×™×œ ×ª×ª×•×•×¡×£ ×‘×’×¨×¡×” ×”×‘××”!')">ğŸ“§ ×©×œ×— ×‘××™×™×œ</button>
                <button class="btn" style="background: #ff9800; color: white;" onclick="alert('×ª×›×•× ×ª ×©×™×ª×•×£ ×ª×ª×•×•×¡×£ ×‘×’×¨×¡×” ×”×‘××”!')">ğŸ”— ×©×ª×£ ×§×™×©×•×¨</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE = '/api/dashboard';
        const USE_REAL_API = true; // Set to false for demo mode
        
        let feedbackChart;
        const feedbackData = {
            week: {
                labels: ['×™×•× ×›×™×£ ×—×•× ×›×™×', '×™×•× ×›×™×£ ××ª× ×“×‘×™×', '×‘×™×§×•×¨ ×‘×‘×™×ª ×—×•×œ×™×', '×—×•× ×›×•×ª ×¨×’×™×œ×”'],
                data: [12, 18, 8, 34]
            },
            month: {
                labels: ['×™×•× ×›×™×£ ×—×•× ×›×™×', '×™×•× ×›×™×£ ××ª× ×“×‘×™×', '×‘×™×§×•×¨ ×‘×‘×™×ª ×—×•×œ×™×', '×—×•× ×›×•×ª ×¨×’×™×œ×”'],
                data: [45, 67, 32, 156]
            },
            year: {
                labels: ['×™×•× ×›×™×£ ×—×•× ×›×™×', '×™×•× ×›×™×£ ××ª× ×“×‘×™×', '×‘×™×§×•×¨ ×‘×‘×™×ª ×—×•×œ×™×', '×—×•× ×›×•×ª ×¨×’×™×œ×”'],
                data: [234, 389, 178, 987]
            },
            all: {
                labels: ['×™×•× ×›×™×£ ×—×•× ×›×™×', '×™×•× ×›×™×£ ××ª× ×“×‘×™×', '×‘×™×§×•×¨ ×‘×‘×™×ª ×—×•×œ×™×', '×—×•× ×›×•×ª ×¨×’×™×œ×”'],
                data: [567, 892, 445, 2341]
            }
        };
        
        // Helper function to get CSRF token
        function getCSRFToken() {
            return document.cookie.split('; ')
                .find(row => row.startsWith('csrftoken='))
                ?.split('=')[1];
        }

        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        font: { size: 12, weight: 'bold' },
                        padding: 20
                    }
                },
                tooltip: {
                    bodyFont: { size: 12, weight: 'bold' }
                }
            }
        };

        // Tutorship Status Pie Chart
        const tutorshipCtx = document.getElementById('tutorshipChart').getContext('2d');
        new Chart(tutorshipCtx, {
            type: 'pie',
            data: {
                labels: ['×¢× ×—×•× ×š', '×××ª×™× ×•×ª'],
                datasets: [{
                    data: [613, 234],
                    backgroundColor: ['#4caf50', '#f44336']
                }]
            },
            options: chartOptions
        });

        // Tutors Status Pie Chart
        const tutorsCtx = document.getElementById('tutorsStatusChart').getContext('2d');
        new Chart(tutorsCtx, {
            type: 'pie',
            data: {
                labels: ['×××ª×™× ×™× ×œ×¨××™×•×Ÿ', '×¤×¢×™×œ×™×'],
                datasets: [{
                    data: [47, 89],
                    backgroundColor: ['#f44336', '#4caf50']
                }]
            },
            options: chartOptions
        });

        // Feedback by Type Pie Chart (NEW)
        const feedbackCtx = document.getElementById('feedbackChart').getContext('2d');
        feedbackChart = new Chart(feedbackCtx, {
            type: 'pie',
            data: {
                labels: feedbackData.week.labels,
                datasets: [{
                    data: feedbackData.week.data,
                    backgroundColor: ['#667eea', '#764ba2', '#ff6b6b', '#4caf50']
                }]
            },
            options: chartOptions
        });

        // Cities Bar Chart
        const citiesCtx = document.getElementById('citiesChart').getContext('2d');
        new Chart(citiesCtx, {
            type: 'bar',
            data: {
                labels: ['×ª×œ ××‘×™×‘', '×™×¨×•×©×œ×™×', '×—×™×¤×”', '×‘××¨ ×©×‘×¢', '×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ', '×¤×ª×— ×ª×§×•×•×”', '××©×§×œ×•×Ÿ', '×œ×•×“', '×¨××œ×”', '××•×“×™×¢×™×Ÿ', '×’×‘×¢×ª×™×™×', '×”×¨×¦×œ×™×”'],
                datasets: [{
                    label: '××©×¤×—×•×ª ×”×××ª×™× ×•×ª',
                    data: [45, 38, 28, 22, 19, 17, 14, 12, 11, 10, 9, 9],
                    backgroundColor: '#667eea',
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: { beginAtZero: true }
                }
            }
        });

        // Recent Tutorships Bar Chart
        const recentCtx = document.getElementById('recentTutorshipsChart').getContext('2d');
        new Chart(recentCtx, {
            type: 'bar',
            data: {
                labels: ['×“×•×“ ×œ×•×™', '×¨×—×œ ××©×”', '×™×¢×§×‘ ×‘×Ÿ', '××¨×™× ×™×©×¨××œ×™', '××“× ×¡×™× ×™', '×œ×™××•×¨ ×›×”×Ÿ', '××•×¨ ×’×‘×¨×™××œ', '×“× ×™××œ ×¦×“×§×”', '× ×¢××™ ×œ×‘×•×‘×™×¥', '××•×¤×™×¨ ×¡×’×œ'],
                datasets: [{
                    label: '×™××™× ××”×ª×—×œ×”',
                    data: [21, 26, 28, 31, 35, 38, 42, 45, 49, 52],
                    backgroundColor: '#764ba2',
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // Age Groups Bar Chart
        const ageCtx = document.getElementById('ageGroupsChart').getContext('2d');
        new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: ['6-8 ×©× ×™×', '9-11 ×©× ×™×', '12-14 ×©× ×™×', '15-17 ×©× ×™×'],
                datasets: [{
                    label: '×”×–×“×× ×•×™×•×ª ×”×ª×××”',
                    data: [156, 134, 98, 67],
                    backgroundColor: '#4caf50',
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // Interactive Functions
        function changeTimeframe(period) {
            document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            const newData = feedbackData[period];
            feedbackChart.data.datasets[0].data = newData.data;
            feedbackChart.update();
        }

        function refreshDashboard() {
            alert('ğŸ”„ ××¨×¢× ×Ÿ ××ª ×œ×•×— ×”×‘×§×¨×”...\n×‘×™×™×¦×•×¨ ×××™×ª×™, ×›×œ ×”× ×ª×•× ×™× ×™×ª×¢×“×›× ×• ××”×©×¨×ª!');
        }

        function scrollToAI() {
            document.getElementById('ai-section').scrollIntoView({ behavior: 'smooth' });
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            if (!message) return;

            const messagesContainer = document.getElementById('chat-messages');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'ai-message user';
            userMsg.innerHTML = `<strong>××ª×”:</strong> ${message}`;
            messagesContainer.appendChild(userMsg);

            input.value = '';

            // Show typing indicator
            const typingIndicator = document.getElementById('typing-indicator');
            typingIndicator.classList.add('active');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Get AI response
            if (USE_REAL_API) {
                try {
                    const response = await fetch(`${API_BASE}/ai-chat/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        },
                        body: JSON.stringify({ message })
                    });
                    
                    const data = await response.json();
                    typingIndicator.classList.remove('active');
                    
                    const aiMsg = document.createElement('div');
                    aiMsg.className = 'ai-message assistant';
                    aiMsg.innerHTML = `<strong>AI:</strong> ${data.response}`;
                    messagesContainer.appendChild(aiMsg);
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                } catch (error) {
                    console.error('Error:', error);
                    typingIndicator.classList.remove('active');
                    // Fallback to demo response
                    showDemoResponse(message, messagesContainer);
                }
            } else {
                // Demo mode
                setTimeout(() => {
                    typingIndicator.classList.remove('active');
                    showDemoResponse(message, messagesContainer);
                }, 1500);
            }
        }
        
        function showDemoResponse(message, container) {
            const aiMsg = document.createElement('div');
            aiMsg.className = 'ai-message assistant';
            let response = getAIResponse(message);
            aiMsg.innerHTML = `<strong>AI:</strong> ${response}`;
            container.appendChild(aiMsg);
            container.scrollTop = container.scrollHeight;
        }

        function getAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('×•×™×“××•') || lowerMessage.includes('×¡×¨×˜×•×Ÿ')) {
                return '××¦×•×™×Ÿ! ×× ×™ ×¨×•××” ×©×‘×—×¨×ª:<br>â€¢ ×˜×•×•×— ×–××Ÿ: ×—×•×“×© ××—×¨×•×Ÿ<br>â€¢ ××©×š: 2-3 ×“×§×•×ª<br>â€¢ ×¢××•×“×™×: ×œ×•×— ×‘×§×¨×”, ××©×¤×—×•×ª, ×—×•× ×›×™×, ××ª× ×“×‘×™×<br>â€¢ ×¡×’× ×•×Ÿ: ××§×¦×•×¢×™ ×•×¨×©××™<br><br>×”×× ×ª×¨×¦×” ×œ×©× ×•×ª ××©×”×• ×œ×¤× ×™ ×©××ª×—×™×œ ×œ×™×™×¦×¨ ××ª ×”×¡×¨×˜×•×Ÿ?';
            }
            
            if (lowerMessage.includes('×›×Ÿ') || lowerMessage.includes('×”×ª×—×œ') || lowerMessage.includes('×‘×¡×“×¨')) {
                return '× ×”×“×¨! ××ª×—×™×œ ×œ×™×™×¦×¨ ××ª ×”×¡×¨×˜×•×Ÿ ×¢×›×©×™×•... ğŸ¬<br>×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ "×¦×•×¨ ×¡×¨×˜×•×Ÿ ×¡×§×™×¨×”" ×œ××˜×” ×›×“×™ ×œ×¨××•×ª ×“×•×’××”!';
            }
            
            if (lowerMessage.includes('××©×¤×—×•×ª') || lowerMessage.includes('× ×ª×•× ×™×')) {
                return '×‘×—×•×“×© ×”××—×¨×•×Ÿ:<br>â€¢ 847 ××©×¤×—×•×ª ×¨×©×•××•×ª ×‘××¢×¨×›×ª<br>â€¢ 67 ××©×¤×—×•×ª ×—×“×©×•×ª (+12%)<br>â€¢ 234 ××©×¤×—×•×ª ×××ª×™× ×•×ª ×œ×—×•× ×š<br>â€¢ 613 ×—×•× ×›×•×™×•×ª ×¤×¢×™×œ×•×ª<br><br>×”×× ×ª×¨×¦×” ×œ×¨××•×ª ××ª ×”× ×ª×•× ×™× ×”××œ×” ×‘×¡×¨×˜×•×Ÿ?';
            }
            
            return '×× ×™ ×›××Ÿ ×œ×¢×–×•×¨! ××¤×©×¨ ×œ×©××•×œ ××•×ª×™ ×¢×œ:<br>â€¢ × ×ª×•× ×™ ×”××¢×¨×›×ª<br>â€¢ ×™×¦×™×¨×ª ×¡×¨×˜×•×Ÿ ×¡×§×™×¨×”<br>â€¢ ×”×ª×××ª ××¤×©×¨×•×™×•×ª ×”×¡×¨×˜×•×Ÿ<br>â€¢ ××• ×›×œ ×©××œ×” ××—×¨×ª ğŸ˜Š';
        }

        async function generateVideo() {
            const timeRange = document.getElementById('timeRange').value;
            const duration = document.getElementById('videoDuration').value;
            const style = document.getElementById('videoStyle').value;
            
            const selectedPages = [];
            if (document.getElementById('dash').checked) selectedPages.push('×œ×•×— ×‘×§×¨×”');
            if (document.getElementById('fam').checked) selectedPages.push('××©×¤×—×•×ª');
            if (document.getElementById('tut').checked) selectedPages.push('×—×•× ×›×™×');
            if (document.getElementById('vol').checked) selectedPages.push('××ª× ×“×‘×™×');
            if (document.getElementById('feed').checked) selectedPages.push('××©×•×‘');
            if (document.getElementById('tasks').checked) selectedPages.push('××©×™××•×ª');

            // Add confirmation message to chat
            const messagesContainer = document.getElementById('chat-messages');
            const aiMsg = document.createElement('div');
            aiMsg.className = 'ai-message assistant';
            aiMsg.innerHTML = `<strong>AI:</strong> ××ª×—×™×œ ×œ×™×™×¦×¨ ×¡×¨×˜×•×Ÿ!<br><br>
                ğŸ“Š <strong>×¤×¨×˜×™ ×”×¡×¨×˜×•×Ÿ:</strong><br>
                â€¢ ×˜×•×•×— ×–××Ÿ: ${timeRange}<br>
                â€¢ ××©×š: ${duration}<br>
                â€¢ ×¢××•×“×™×: ${selectedPages.join(', ')}<br>
                â€¢ ×¡×’× ×•×Ÿ: ${style}<br><br>
                ×–×” ×™×™×§×— ×›××” ×©× ×™×•×ª... ğŸ¬`;
            messagesContainer.appendChild(aiMsg);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Start progress animation
            const progressFill = document.getElementById('progress-fill');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressFill.style.width = progress + '%';
                progressFill.textContent = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 200);

            // Generate video via API
            if (USE_REAL_API) {
                try {
                    const response = await fetch(`${API_BASE}/generate-video/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        },
                        body: JSON.stringify({
                            timeframe: timeRange,
                            duration: duration,
                            pages: selectedPages,
                            style: style
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // Store video URL for download
                        window.currentVideoUrl = data.download_url;
                        
                        setTimeout(() => {
                            document.getElementById('video-modal').classList.add('active');
                        }, 500);
                    } else {
                        alert('×©×’×™××” ×‘×™×¦×™×¨×ª ×”×¡×¨×˜×•×Ÿ: ' + data.error);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×©×¨×ª');
                }
            } else {
                // Demo mode
                setTimeout(() => {
                    document.getElementById('video-modal').classList.add('active');
                }, 2000);
            }
        }

        function closeModal() {
            document.getElementById('video-modal').classList.remove('active');
            document.getElementById('progress-fill').style.width = '0%';
            document.getElementById('progress-fill').textContent = '0%';
        }

        async function exportToPPT() {
            // Show success message
            const successMsg = document.getElementById('success-message');
            successMsg.classList.add('active');
            setTimeout(() => successMsg.classList.remove('active'), 3000);

            if (USE_REAL_API) {
                try {
                    const response = await fetch(`${API_BASE}/export-ppt/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        },
                        body: JSON.stringify({})
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // Download the file
                        window.location.href = data.download_url;
                    } else {
                        alert('×©×’×™××” ×‘×™×™×¦×•× PPT: ' + data.error);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    // Fallback to client-side generation
                    generatePPTClientSide();
                }
            } else {
                // Demo mode - use client-side generation
                generatePPTClientSide();
            }
        }
        
        function generatePPTClientSide() {
            // Create presentation using PptxGenJS
            const pptx = new PptxGenJS();
            pptx.layout = 'LAYOUT_WIDE';
            pptx.author = 'ChildSmile System';
            pptx.title = 'Dashboard Overview';

            // Add title slide
            const slide1 = pptx.addSlide();
            slide1.background = { fill: '667eea' };
            slide1.addText('×œ×•×— ×‘×§×¨×” - ChildSmile', {
                x: 1, y: 2, w: 10, h: 1.5,
                fontSize: 44, bold: true, color: 'FFFFFF',
                align: 'center', fontFace: 'Arial'
            });
            slide1.addText('×¡×§×™×¨×ª ××¦×‘ ××¢×¨×›×ª', {
                x: 1, y: 3.5, w: 10, h: 0.5,
                fontSize: 24, color: 'FFFFFF',
                align: 'center', fontFace: 'Arial'
            });

            // Add KPIs slide
            const slide2 = pptx.addSlide();
            slide2.addText('××“×“×™× ×¢×™×§×¨×™×™×', {
                x: 0.5, y: 0.5, w: 12, h: 0.5,
                fontSize: 32, bold: true, color: '667eea', fontFace: 'Arial'
            });

            const kpiData = [
                ['××“×“', '×¢×¨×š'],
                ['×¡×”"×› ××©×¤×—×•×ª', '847'],
                ['××©×¤×—×•×ª ×”×××ª×™× ×•×ª', '234'],
                ['×—×•× ×›×•×™×•×ª ×¤×¢×™×œ×•×ª', '613'],
                ['×—×•× ×›×™× ×”×××ª×™× ×™×', '47'],
                ['×× ×©×™ ×”×¦×•×•×ª', '23']
            ];

            slide2.addTable(kpiData, {
                x: 2, y: 1.5, w: 8, h: 3,
                fontSize: 18, fontFace: 'Arial',
                fill: { color: 'F1F5F9' },
                color: '334155'
            });

            // Save the file
            pptx.writeFile({ fileName: 'ChildSmile_Dashboard.pptx' });
        }

        function downloadVideo() {
            if (USE_REAL_API && window.currentVideoUrl) {
                window.location.href = window.currentVideoUrl;
            } else {
                alert('×‘×™×™×¦×•×¨ ×××™×ª×™, ×”×¡×¨×˜×•×Ÿ ×™×•×¨×“ ×›××Ÿ!\n×”×¡×¨×˜×•×Ÿ ×™×›×œ×•×œ:\nâ€¢ ×§×¨×™×™× ×•×ª AI ××§×¦×•×¢×™×ª\nâ€¢ ×’×¨×¤×™× ×× ×™××¦×™×•×ª\nâ€¢ × ×ª×•× ×™× ×—×™×™×\nâ€¢ ××•×–×™×§×ª ×¨×§×¢');
            }
        }
        
        // Close modal on outside click
        document.getElementById('video-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Load initial dashboard data on page load
        if (USE_REAL_API) {
            window.addEventListener('DOMContentLoaded', async function() {
                try {
                    const response = await fetch(`${API_BASE}/data/?timeframe=month`);
                    const data = await response.json();
                    
                    // Update KPIs if data loaded successfully
                    if (data.kpis) {
                        console.log('Dashboard data loaded:', data);
                        // You can update the HTML here with real data
                    }
                } catch (error) {
                    console.log('Using demo data - API not available');
                }
            });
        }
    </script>
</body>
</html>
